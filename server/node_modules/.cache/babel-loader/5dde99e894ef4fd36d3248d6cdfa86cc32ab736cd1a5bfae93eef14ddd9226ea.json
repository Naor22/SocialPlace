{"ast":null,"code":"import _slicedToArray from\"C:/Users/Naor/Desktop/code/Summer Projects/SocialPlace/social/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import PostText from'./PostText';import*as React from'react';import Stack from'@mui/material/Stack';import Button from'@mui/material/Button';import{useState}from'react';import{useDispatch,useSelector}from'react-redux';import{setUpdate}from'../features/feedSlice';import Avatar from'@mui/material/Avatar';import Box from'@mui/material/Box';import Card from'@mui/material/Card';import CardContent from'@mui/material/CardContent';import api from'../api/axios';import PhotoIcon from'@mui/icons-material/Photo';import{sendMessage}from'../api/socketManager';import{addMessage,removeMessage}from'../features/chatSlice';import{v4 as uuidv4}from'uuid';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatSendMessage=function ChatSendMessage(){var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var userOb=useSelector(function(state){var _state$auth;return(_state$auth=state.auth)===null||_state$auth===void 0?void 0:_state$auth.userOb;});var currentChat=useSelector(function(state){return state.chat.currentChat;});var handlePost=function handlePost(text){if(text===\"\")return;setText(\"\");var uniqueid=uuidv4();dispatch(addMessage({uniqueid:uniqueid,userId:userOb._id,content:text,created_at:new Date()}));sendMessage('sendMessage',{chatId:currentChat._id,userId:userOb._id,content:text,created_at:new Date()},function(response){if(!response.success){dispatch(removeMessage({uniqueid:uniqueid,chatId:currentChat,userId:userOb,content:text,created_at:new Date()}));}});};var clickEnter=function clickEnter(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handlePost(text);}};return/*#__PURE__*/_jsx(Card,{sx:{backgroundColor:'white'},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Stack,{spacing:1,direction:\"row\",sx:{display:'flex',width:'100%'},children:[/*#__PURE__*/_jsx(Avatar,{\"aria-label\":\"recipe\",children:/*#__PURE__*/_jsx(\"img\",{src:userOb.avatar})}),/*#__PURE__*/_jsx(PostText,{setText:setText,text:text,clickEnter:clickEnter,placeholder:\"Write you message here\"}),/*#__PURE__*/_jsx(Button,{disabled:currentChat?false:true,variant:\"contained\",size:\"small\",sx:{borderRadius:'20px'},onClick:function onClick(){handlePost(text);},children:\"Send\"})]})})});};export default ChatSendMessage;","map":{"version":3,"names":["PostText","React","Stack","Button","useState","useDispatch","useSelector","setUpdate","Avatar","Box","Card","CardContent","api","PhotoIcon","sendMessage","addMessage","removeMessage","v4","uuidv4","jsx","_jsx","jsxs","_jsxs","ChatSendMessage","dispatch","_useState","_useState2","_slicedToArray","text","setText","userOb","state","_state$auth","auth","currentChat","chat","handlePost","uniqueid","userId","_id","content","created_at","Date","chatId","response","success","clickEnter","e","key","shiftKey","preventDefault","sx","backgroundColor","children","spacing","direction","display","width","src","avatar","placeholder","disabled","variant","size","borderRadius","onClick"],"sources":["C:/Users/Naor/Desktop/code/Summer Projects/SocialPlace/social/src/components/ChatSendMessage.js"],"sourcesContent":["import PostText from './PostText';\r\nimport * as React from 'react';\r\nimport Stack from '@mui/material/Stack';\r\nimport Button from '@mui/material/Button';\r\nimport { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setUpdate } from '../features/feedSlice';\r\nimport Avatar from '@mui/material/Avatar';\r\nimport Box from '@mui/material/Box';\r\nimport Card from '@mui/material/Card';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport api from '../api/axios';\r\nimport PhotoIcon from '@mui/icons-material/Photo';\r\nimport { sendMessage } from '../api/socketManager'\r\nimport { addMessage, removeMessage } from '../features/chatSlice';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\n\r\nconst ChatSendMessage = () => {\r\n    const dispatch = useDispatch();\r\n    const [text, setText] = useState(\"\");\r\n    const userOb = useSelector((state) => state.auth?.userOb);\r\n    const currentChat = useSelector((state) => state.chat.currentChat);\r\n\r\n    const handlePost = (text) => {\r\n        if (text === \"\") return;\r\n        setText(\"\");\r\n        const uniqueid = uuidv4();\r\n        dispatch(addMessage({ uniqueid: uniqueid, userId: userOb._id, content: text, created_at: new Date() }))\r\n        sendMessage('sendMessage', { chatId: currentChat._id, userId: userOb._id, content: text, created_at: new Date() }, (response) => {\r\n\r\n            if (!response.success) {\r\n                dispatch(removeMessage({ uniqueid: uniqueid, chatId: currentChat, userId: userOb, content: text, created_at: new Date() }))\r\n            }\r\n        }\r\n        )\r\n\r\n    }\r\n    const clickEnter = (e) => {\r\n        if (e.key === 'Enter' && !e.shiftKey) {\r\n            e.preventDefault();\r\n            handlePost(text)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Card sx={{ backgroundColor: 'white' }}>\r\n            <CardContent>\r\n                <Stack spacing={1} direction=\"row\" sx={{ display: 'flex', width: '100%' }}>\r\n                    <Avatar aria-label=\"recipe\">\r\n                        <img src={userOb.avatar}></img>\r\n                    </Avatar>\r\n\r\n                    <PostText setText={setText} text={text} clickEnter={clickEnter} placeholder={\"Write you message here\"} />\r\n                    <Button disabled={currentChat ? false : true} variant=\"contained\" size=\"small\" sx={{ borderRadius: '20px' }} onClick={() => { handlePost(text); }}>Send</Button>\r\n\r\n                </Stack>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n\r\nexport default ChatSendMessage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}