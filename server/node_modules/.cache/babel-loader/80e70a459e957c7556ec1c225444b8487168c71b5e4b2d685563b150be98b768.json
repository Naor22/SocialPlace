{"ast":null,"code":"import*as React from'react';import List from'@mui/material/List';import ListItem from'@mui/material/ListItem';import Divider from'@mui/material/Divider';import ListItemText from'@mui/material/ListItemText';import ListItemAvatar from'@mui/material/ListItemAvatar';import Avatar from'@mui/material/Avatar';import Typography from'@mui/material/Typography';import{useSelector}from'react-redux';import ChatMessage from'./ChatMessage';import ChatSendMessage from'./ChatSendMessage';import{useRef,useEffect}from'react';import{addMessage}from'../features/chatSlice';import{registerMessageHandler,unregisterMessageHandler}from'../api/socketManager';import{useDispatch}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatBox(){var dispatch=useDispatch();var messagesEndRef=useRef(null);var currentChat=useSelector(function(state){return state.chat.currentChat;});var currentChatContent=useSelector(function(state){return state.chat.currentChatContent;});var scrollToBottom=function scrollToBottom(){var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(function(){var handleMessage=function handleMessage(data){if(data.chatId===currentChat._id)dispatch(addMessage(data.data));};registerMessageHandler('chatMsg',handleMessage);return function(){unregisterMessageHandler('chatMsg');};});useEffect(function(){scrollToBottom();},[currentChatContent]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-box shadow-5\",style:{borderRadius:'20px',overflow:'hidden',margin:0,padding:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{maxHeight:700,height:700,overflowY:'auto',scrollbarWidth:'none',msOverflowStyle:'none',backgroundColor:'white',padding:0,margin:0},children:[/*#__PURE__*/_jsx(List,{sx:{width:'100%',maxWidth:360,bgcolor:'background.paper',height:'100%',margin:0,padding:0},children:currentChat?currentChatContent===null||currentChatContent===void 0?void 0:currentChatContent.map(function(message){return/*#__PURE__*/_jsx(ChatMessage,{message:message},message._id);}):null}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n                        ::-webkit-scrollbar {\\n                            display: none;\\n                        }\\n                    \"})]}),/*#__PURE__*/_jsx(ChatSendMessage,{})]});}","map":{"version":3,"names":["React","List","ListItem","Divider","ListItemText","ListItemAvatar","Avatar","Typography","useSelector","ChatMessage","ChatSendMessage","useRef","useEffect","addMessage","registerMessageHandler","unregisterMessageHandler","useDispatch","jsx","_jsx","jsxs","_jsxs","ChatBox","dispatch","messagesEndRef","currentChat","state","chat","currentChatContent","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleMessage","data","chatId","_id","className","style","borderRadius","overflow","margin","padding","children","maxHeight","height","overflowY","scrollbarWidth","msOverflowStyle","backgroundColor","sx","width","maxWidth","bgcolor","map","message","ref"],"sources":["C:/Users/Naor/Desktop/code/Summer Projects/SocialPlace/social/src/components/ChatBox.js"],"sourcesContent":["import * as React from 'react';\r\nimport List from '@mui/material/List';\r\nimport ListItem from '@mui/material/ListItem';\r\nimport Divider from '@mui/material/Divider';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport ListItemAvatar from '@mui/material/ListItemAvatar';\r\nimport Avatar from '@mui/material/Avatar';\r\nimport Typography from '@mui/material/Typography';\r\nimport { useSelector } from 'react-redux'\r\nimport ChatMessage from './ChatMessage'\r\nimport ChatSendMessage from './ChatSendMessage'\r\nimport { useRef, useEffect } from 'react'\r\nimport { addMessage } from '../features/chatSlice';\r\nimport { registerMessageHandler, unregisterMessageHandler } from '../api/socketManager';\r\nimport { useDispatch } from 'react-redux'\r\nexport default function ChatBox() {\r\n    const dispatch = useDispatch();\r\n    const messagesEndRef = useRef(null);\r\n    const currentChat = useSelector((state) => state.chat.currentChat);\r\n    const currentChatContent = useSelector((state) => state.chat.currentChatContent);\r\n\r\n    const scrollToBottom = () => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    };\r\n\r\n\r\n    useEffect(() => {\r\n        const handleMessage = (data) => {\r\n            if(data.chatId === currentChat._id)\r\n            dispatch(addMessage(data.data));\r\n\r\n        };\r\n        registerMessageHandler('chatMsg', handleMessage);\r\n\r\n        return () => {\r\n            unregisterMessageHandler('chatMsg');\r\n        }\r\n\r\n    },);\r\n\r\n    useEffect(() => {\r\n\r\n        scrollToBottom()\r\n    }, [currentChatContent]);\r\n\r\n    return (\r\n        <div className=\"chat-box shadow-5\" style={{ borderRadius: '20px', overflow: 'hidden', margin: 0, padding: 0 }}>\r\n        <div style={{ maxHeight: 700, height: 700, overflowY: 'auto', scrollbarWidth: 'none', msOverflowStyle: 'none', backgroundColor: 'white', padding: 0, margin: 0 }}>\r\n            <List sx={{ width: '100%', maxWidth: 360, bgcolor: 'background.paper', height: '100%', margin: 0, padding: 0 }}>\r\n                    {currentChat ? currentChatContent?.map((message) => (\r\n                        <ChatMessage key={message._id} message={message} />\r\n                    )) : null}\r\n                </List>\r\n                <div ref={messagesEndRef} />\r\n                <style>\r\n                    {`\r\n                        ::-webkit-scrollbar {\r\n                            display: none;\r\n                        }\r\n                    `}\r\n                </style>\r\n            </div>\r\n            <ChatSendMessage />\r\n        </div>\r\n    );\r\n    \r\n\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}