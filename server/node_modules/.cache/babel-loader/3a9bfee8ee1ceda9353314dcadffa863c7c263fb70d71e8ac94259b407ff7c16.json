{"ast":null,"code":"import _slicedToArray from\"C:/Users/Naor/Desktop/code/Summer Projects/SocialPlace/social/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as React from'react';import Card from'@mui/material/Card';import CardHeader from'@mui/material/CardHeader';import CardContent from'@mui/material/CardContent';import Avatar from'@mui/material/Avatar';import IconButton from'@mui/material/IconButton';import Typography from'@mui/material/Typography';import{red}from'@mui/material/colors';import Menu from'@mui/material/Menu';import api from\"../api/axios\";import MenuItem from'@mui/material/MenuItem';import MoreVertIcon from'@mui/icons-material/MoreVert';import EditIcon from'@mui/icons-material/Edit';import DeleteIcon from'@mui/icons-material/Delete';import FavoriteIcon from'@mui/icons-material/Favorite';import FavoriteBorderIcon from'@mui/icons-material/FavoriteBorder';import{useSelector,useDispatch}from'react-redux';import{setUpdate,setPosts}from'../features/feedSlice';import{sendMessage}from'../api/socketManager';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comment(_ref){var postId=_ref.postId,comment=_ref.comment,compareDates=_ref.compareDates,StyledBadge=_ref.StyledBadge,navigate=_ref.navigate,changeAlert=_ref.changeAlert;var dispatch=useDispatch();var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),anchorEl=_React$useState2[0],setAnchorEl=_React$useState2[1];var userOb=useSelector(function(state){var _state$auth;return(_state$auth=state.auth)===null||_state$auth===void 0?void 0:_state$auth.userOb;});var userID=userOb._id;var handleClick=function handleClick(event){setAnchorEl(event.currentTarget);};var handleClose=function handleClose(){setAnchorEl(null);};var DeleteComment=function DeleteComment(){api.post(\"/deletecomment\",{postId:postId,commentId:_id,userId:userID}).then(function(res){dispatch(setUpdate());}).catch(function(err){console.log(\"Error: \",err);});};var userId=comment.userId,content=comment.content,created_at=comment.created_at,likes=comment.likes,_id=comment._id;var name=userId.name,avatar=userId.avatar;var dates=created_at.toString().substring(0,10);var times=created_at.toString().substring(11,16);var likeComment=function likeComment(){sendMessage('likeComment',{postId:postId,comment:_id,userId:userID},function(response){if(response.success){dispatch(setPosts(response.data));}else{api.post(\"/likecomment\",{postId:postId,comment:_id,userId:userID}).then(function(res){dispatch(setUpdate());}).catch(function(err){changeAlert(\"There was a problem liking this comment\");});}});};var unLikeComment=function unLikeComment(){api.post(\"/unlikecomment\",{user:userID,postId:postId,comment:_id}).then(function(res){dispatch(setUpdate());}).catch(function(err){console.log(\"Error: \",err);});};return/*#__PURE__*/_jsx(\"div\",{className:\"pa2\",children:/*#__PURE__*/_jsxs(Card,{sx:{maxWidth:'auto'},children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{sx:{bgcolor:red[500]},\"aria-label\":\"recipe\",onClick:function onClick(){return navigate(\"/profile/\".concat(userId._id));},children:/*#__PURE__*/_jsx(\"img\",{src:avatar})}),action:userID===userId._id?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"settings\",onClick:handleClick,children:/*#__PURE__*/_jsx(MoreVertIcon,{})}),/*#__PURE__*/_jsxs(Menu,{id:\"simple-menu\",anchorEl:anchorEl,open:Boolean(anchorEl),onClose:handleClose,children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleClose,children:[/*#__PURE__*/_jsx(EditIcon,{style:{color:'blue'}}),\"  Edit\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:function onClick(){DeleteComment();handleClose();},children:[/*#__PURE__*/_jsx(DeleteIcon,{style:{color:'red'}}),\"Delete\"]})]})]}):null,title:name,subheader:compareDates(created_at)?times:dates+\" \"+times}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:content})}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"like\",children:/*#__PURE__*/_jsx(StyledBadge,{badgeContent:likes.length,color:\"secondary\",children:likes.includes(userID)?/*#__PURE__*/_jsx(FavoriteIcon,{style:{color:'red'},onClick:function onClick(){return unLikeComment();}}):/*#__PURE__*/_jsx(FavoriteBorderIcon,{onClick:function onClick(){return likeComment();}})})})]})});}","map":{"version":3,"names":["React","Card","CardHeader","CardContent","Avatar","IconButton","Typography","red","Menu","api","MenuItem","MoreVertIcon","EditIcon","DeleteIcon","FavoriteIcon","FavoriteBorderIcon","useSelector","useDispatch","setUpdate","setPosts","sendMessage","jsx","_jsx","jsxs","_jsxs","Comment","_ref","postId","comment","compareDates","StyledBadge","navigate","changeAlert","dispatch","_React$useState","useState","_React$useState2","_slicedToArray","anchorEl","setAnchorEl","userOb","state","_state$auth","auth","userID","_id","handleClick","event","currentTarget","handleClose","DeleteComment","post","commentId","userId","then","res","catch","err","console","log","content","created_at","likes","name","avatar","dates","toString","substring","times","likeComment","response","success","data","unLikeComment","user","className","children","sx","maxWidth","bgcolor","onClick","concat","src","action","id","open","Boolean","onClose","style","color","title","subheader","variant","badgeContent","length","includes"],"sources":["C:/Users/Naor/Desktop/code/Summer Projects/SocialPlace/social/src/components/Comment.js"],"sourcesContent":["import * as React from 'react';\r\n\r\nimport Card from '@mui/material/Card';\r\nimport CardHeader from '@mui/material/CardHeader';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport Avatar from '@mui/material/Avatar';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Typography from '@mui/material/Typography';\r\nimport { red } from '@mui/material/colors';\r\nimport Menu from '@mui/material/Menu';\r\nimport api from \"../api/axios\";\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport EditIcon from '@mui/icons-material/Edit';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport FavoriteIcon from '@mui/icons-material/Favorite';\r\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setUpdate, setPosts } from '../features/feedSlice';\r\nimport { sendMessage } from '../api/socketManager';\r\n\r\nexport default function Comment({ postId, comment, compareDates, StyledBadge, navigate, changeAlert }) {\r\n    const dispatch = useDispatch();\r\n    const [anchorEl, setAnchorEl] = React.useState(null);\r\n    const userOb = useSelector((state) => state.auth?.userOb);\r\n    const userID = userOb._id;\r\n\r\n    const handleClick = (event) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n    const DeleteComment = () => {\r\n        api\r\n            .post(\"/deletecomment\", {\r\n                postId: postId,\r\n                commentId: _id,\r\n                userId: userID,\r\n            })\r\n            .then((res) => {\r\n                dispatch(setUpdate());\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"Error: \", err);\r\n            });\r\n    }\r\n\r\n\r\n    const { userId, content, created_at, likes, _id } = comment;\r\n    const { name, avatar } = userId\r\n    let dates = created_at.toString().substring(0, 10);\r\n    let times = created_at.toString().substring(11, 16);\r\n\r\n    const likeComment = () => {\r\n        sendMessage('likeComment', { postId: postId, comment: _id, userId: userID }, (response) => {\r\n            if (response.success) {\r\n                dispatch(setPosts(response.data))\r\n            } else {\r\n                api\r\n                    .post(\"/likecomment\", {\r\n                        postId: postId,\r\n                        comment: _id,\r\n                        userId: userID,\r\n                    })\r\n                    .then((res) => {\r\n                        dispatch(setUpdate());\r\n                    })\r\n                    .catch((err) => {\r\n                        changeAlert(\"There was a problem liking this comment\")\r\n                    });\r\n            }\r\n        }\r\n        )\r\n\r\n    }\r\n\r\n    const unLikeComment = () => {\r\n        api.post(\"/unlikecomment\", { user: userID, postId: postId, comment: _id })\r\n            .then((res) => {\r\n                dispatch(setUpdate());\r\n\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"Error: \", err);\r\n            });\r\n    }\r\n\r\n    return (\r\n        <div className=\"pa2\">\r\n            <Card sx={{ maxWidth: 'auto' }}>\r\n                <CardHeader\r\n                    avatar={\r\n                        <Avatar sx={{ bgcolor: red[500] }} aria-label=\"recipe\" onClick={() => navigate(`/profile/${userId._id}`)}>\r\n                            <img src={avatar}></img>\r\n                        </Avatar>\r\n                    }\r\n                    action={\r\n\r\n                        userID === userId._id ? (\r\n                            <div>\r\n                                <IconButton aria-label=\"settings\" onClick={handleClick}  >\r\n                                    <MoreVertIcon />\r\n                                </IconButton>\r\n                                <Menu\r\n                                    id=\"simple-menu\"\r\n                                    anchorEl={anchorEl}\r\n                                    open={Boolean(anchorEl)}\r\n                                    onClose={handleClose}\r\n                                >\r\n                                    <MenuItem onClick={handleClose}><EditIcon style={{ color: 'blue' }} />  Edit</MenuItem>\r\n                                    <MenuItem onClick={() => {\r\n                                        DeleteComment();\r\n                                        handleClose();\r\n                                    }}><DeleteIcon style={{ color: 'red' }} />Delete</MenuItem>\r\n                                </Menu>\r\n                            </div>\r\n                        ) : null\r\n                    }\r\n                    title={name}\r\n                    subheader={compareDates(created_at) ? times : dates + \" \" + times}\r\n                />\r\n                <CardContent>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                        {content}\r\n                    </Typography>\r\n                </CardContent>\r\n                <IconButton aria-label=\"like\">\r\n                    <StyledBadge badgeContent={likes.length} color=\"secondary\">\r\n                        {likes.includes(userID) ?\r\n                            <FavoriteIcon style={{ color: 'red' }} onClick={() => unLikeComment()} />\r\n                            :\r\n                            <FavoriteBorderIcon onClick={() => likeComment()} />}\r\n                    </StyledBadge>\r\n                </IconButton>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}